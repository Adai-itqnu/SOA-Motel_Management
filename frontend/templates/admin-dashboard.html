<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - Qu·∫£n l√Ω Nh√† Tr·ªç</title>
    <link rel="stylesheet" href="/static/css/admin.css" />
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="header-brand">
        <span>üè†</span>
        <span>Admin Dashboard</span>
      </div>
      <div class="header-user">
        <div class="user-info">
          <div class="user-name" id="userName"></div>
          <div class="user-role">Qu·∫£n tr·ªã vi√™n</div>
        </div>
        <button class="btn-logout" onclick="logout()">ƒêƒÉng xu·∫•t</button>
      </div>
    </header>

    <!-- Layout Container -->
    <div class="layout-container">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-logo">MOTEL HDK</div>
        <nav class="sidebar-menu">
          <div class="menu-section">
            <div class="menu-section-title">MENU</div>
            <a class="menu-item active" data-section="dashboard">
              <span class="menu-item-icon">üìä</span>
              <span class="menu-item-text">Dashboard</span>
            </a>
            <a class="menu-item" data-section="rooms">
              <span class="menu-item-icon">üè†</span>
              <span class="menu-item-text">Qu·∫£n l√Ω Ph√≤ng</span>
            </a>
            <a class="menu-item" data-section="tenants">
              <span class="menu-item-icon">üë•</span>
              <span class="menu-item-text">Qu·∫£n l√Ω Ng∆∞·ªùi Thu√™</span>
            </a>
            <a class="menu-item" data-section="contracts">
              <span class="menu-item-icon">üìÑ</span>
              <span class="menu-item-text">Qu·∫£n l√Ω H·ª£p ƒê·ªìng</span>
            </a>
            <a class="menu-item" data-section="bookings">
              <span class="menu-item-icon">üìÖ</span>
              <span class="menu-item-text">Qu·∫£n l√Ω Booking</span>
            </a>
            <a class="menu-item" data-section="reports">
              <span class="menu-item-icon">üìà</span>
              <span class="menu-item-text">B√°o C√°o & Th·ªëng K√™</span>
            </a>
          </div>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Dashboard Panel -->
        <div id="dashboardPanel" class="content-panel active">
          <div class="page-title">Dashboard T·ªïng Quan</div>
          <div class="page-subtitle">Qu·∫£n l√Ω v√† theo d√µi h·ªá th·ªëng nh√† tr·ªç</div>

          <div class="stats-grid">
            <div class="stat-card" onclick="navigateToSection('rooms')">
              <div class="stat-card-header">
                <div class="stat-icon">üè†</div>
              </div>
              <div class="stat-label">T·ªïng s·ªë ph√≤ng</div>
              <div class="stat-value" id="totalRooms">-</div>
            </div>

            <div class="stat-card" onclick="navigateToSection('rooms')">
              <div class="stat-card-header">
                <div class="stat-icon">‚úÖ</div>
              </div>
              <div class="stat-label">Ph√≤ng tr·ªëng</div>
              <div class="stat-value" id="availableRooms">-</div>
            </div>

            <div class="stat-card" onclick="navigateToSection('tenants')">
              <div class="stat-card-header">
                <div class="stat-icon">üë•</div>
              </div>
              <div class="stat-label">T·ªïng ng∆∞·ªùi thu√™</div>
              <div class="stat-value" id="totalTenants">-</div>
            </div>

            <div class="stat-card" onclick="navigateToSection('contracts')">
              <div class="stat-card-header">
                <div class="stat-icon">üìÑ</div>
              </div>
              <div class="stat-label">H·ª£p ƒë·ªìng ƒëang ho·∫°t ƒë·ªông</div>
              <div class="stat-value" id="activeContracts">-</div>
            </div>

            <div class="stat-card" onclick="navigateToSection('reports')">
              <div class="stat-card-header">
                <div class="stat-icon">üí∞</div>
              </div>
              <div class="stat-label">Doanh thu th√°ng n√†y</div>
              <div class="stat-value" id="monthlyRevenue">-</div>
            </div>

            <div class="stat-card" onclick="navigateToSection('reports')">
              <div class="stat-card-header">
                <div class="stat-icon">üìä</div>
              </div>
              <div class="stat-label">T·ª∑ l·ªá l·∫•p ƒë·∫ßy</div>
              <div class="stat-value" id="occupancyRate">-%</div>
            </div>
          </div>

          <div class="content-section">
            <h2 class="section-title">Th·ªëng k√™ nhanh</h2>
            <div id="quickStats">
              <div class="loading">
                <div class="spinner"></div>
                <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Rooms Panel -->
        <div id="roomsPanel" class="content-panel">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 30px;
            "
          >
            <div>
              <div class="page-title">Qu·∫£n l√Ω Ph√≤ng Tr·ªç</div>
            </div>
            <button class="btn-primary" onclick="openCreateRoomModal()">
              + Th√™m ph√≤ng m·ªõi
            </button>
          </div>

          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-value" id="roomTotalRooms">-</div>
              <div class="stat-label">T·ªïng s·ªë ph√≤ng</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="roomAvailableRooms">-</div>
              <div class="stat-label">Ph√≤ng tr·ªëng</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="roomOccupiedRooms">-</div>
              <div class="stat-label">ƒê√£ cho thu√™</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="roomOccupancyRate">-%</div>
              <div class="stat-label">T·ª∑ l·ªá l·∫•p ƒë·∫ßy</div>
            </div>
          </div>

          <div class="content-section">
            <div class="filters">
              <div class="filter-item">
                <input
                  type="text"
                  id="roomSearchInput"
                  placeholder="T√¨m ki·∫øm ph√≤ng..."
                />
              </div>
              <div class="filter-item">
                <select id="roomStatusFilter">
                  <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                  <option value="available">C√≤n tr·ªëng</option>
                  <option value="occupied">ƒê√£ cho thu√™</option>
                  <option value="maintenance">B·∫£o tr√¨</option>
                </select>
              </div>
            </div>

            <div class="table-container">
              <table id="roomsTable">
                <thead>
                  <tr>
                    <th>M√£ ph√≤ng</th>
                    <th>T√™n ph√≤ng</th>
                    <th>Lo·∫°i ph√≤ng</th>
                    <th>Gi√° thu√™</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>H√†nh ƒë·ªông</th>
                  </tr>
                </thead>
                <tbody id="roomsTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Tenants Panel -->
        <div id="tenantsPanel" class="content-panel">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 30px;
            "
          >
            <div>
              <div class="page-title">Qu·∫£n l√Ω Ng∆∞·ªùi Thu√™</div>
            </div>
            <div>
              <button class="btn-primary" onclick="openCreateTenantModal()">
                + Th√™m ng∆∞·ªùi thu√™
              </button>
            </div>
          </div>

          <!-- Tenants Content -->
          <div id="tenantsTabContent" class="content-section">
            <div class="filters">
              <div class="filter-item">
                <input
                  type="text"
                  id="tenantSearchInput"
                  placeholder="T√¨m ki·∫øm theo t√™n, SƒêT, CMND..."
                />
              </div>
              <div class="filter-item">
                <select id="tenantStatusFilter">
                  <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                  <option value="active">ƒêang ho·∫°t ƒë·ªông</option>
                  <option value="inactive">Ng·ª´ng ho·∫°t ƒë·ªông</option>
                </select>
              </div>
            </div>

            <div class="table-container">
              <table id="tenantsTable">
                <thead>
                  <tr>
                    <th>M√£</th>
                    <th>H·ªç t√™n</th>
                    <th>S·ªë ƒëi·ªán tho·∫°i</th>
                    <th>CMND/CCCD</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>H√†nh ƒë·ªông</th>
                  </tr>
                </thead>
                <tbody id="tenantsTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Contracts Panel -->
        <div id="contractsPanel" class="content-panel">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 30px;
            "
          >
            <div>
              <div class="page-title">Qu·∫£n l√Ω H·ª£p ƒê·ªìng</div>
            </div>
            <div>
              <button
                class="btn-primary"
                onclick="openCreateContractModal()"
              >
                + T·∫°o h·ª£p ƒë·ªìng
              </button>
            </div>
          </div>

          <!-- Contracts Content -->
          <div id="contractsTabContent" class="content-section">
            <div class="filters">
              <div class="filter-item">
                <input
                  type="text"
                  id="contractSearchInput"
                  placeholder="T√¨m ki·∫øm h·ª£p ƒë·ªìng..."
                />
              </div>
              <div class="filter-item">
                <select id="contractStatusFilter">
                  <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                  <option value="active">ƒêang ho·∫°t ƒë·ªông</option>
                  <option value="expired">H·∫øt h·∫°n</option>
                  <option value="terminated">ƒê√£ ch·∫•m d·ª©t</option>
                </select>
              </div>
            </div>

            <div class="table-container">
              <table id="contractsTable">
                <thead>
                  <tr>
                    <th>M√£ h·ª£p ƒë·ªìng</th>
                    <th>Ng∆∞·ªùi thu√™</th>
                    <th>Ph√≤ng</th>
                    <th>Ng√†y b·∫Øt ƒë·∫ßu</th>
                    <th>Ng√†y k·∫øt th√∫c</th>
                    <th>Gi√° thu√™</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>H√†nh ƒë·ªông</th>
                  </tr>
                </thead>
                <tbody id="contractsTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Bookings Panel -->
        <div id="bookingsPanel" class="content-panel">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 30px;
            "
          >
            <div>
              <div class="page-title">Qu·∫£n l√Ω Booking Requests</div>
            </div>
          </div>

          <!-- Bookings Content -->
          <div id="bookingsTabContent" class="content-section">
            <div class="filters">
              <div class="filter-item">
                <input
                  type="text"
                  id="bookingSearchInput"
                  placeholder="T√¨m ki·∫øm booking..."
                />
              </div>
              <div class="filter-item">
                <select id="bookingStatusFilter">
                  <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                  <option value="pending">ƒêang ch·ªù duy·ªát</option>
                  <option value="approved">ƒê√£ duy·ªát</option>
                  <option value="rejected">ƒê√£ t·ª´ ch·ªëi</option>
                  <option value="cancelled">ƒê√£ h·ªßy</option>
                </select>
              </div>
            </div>

            <div class="table-container">
              <table id="bookingsTable">
                <thead>
                  <tr>
                    <th>M√£ booking</th>
                    <th>Ng∆∞·ªùi thu√™</th>
                    <th>Ph√≤ng</th>
                    <th>Ng√†y b·∫Øt ƒë·∫ßu</th>
                    <th>Ng√†y k·∫øt th√∫c</th>
                    <th>Gi√° thu√™/th√°ng</th>
                    <th>Ti·ªÅn c·ªçc</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>H√†nh ƒë·ªông</th>
                  </tr>
                </thead>
                <tbody id="bookingsTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Reports Panel -->
        <div id="reportsPanel" class="content-panel">
          <div class="page-title">B√°o C√°o & Th·ªëng K√™</div>

          <div class="tabs">
            <button class="tab active" onclick="switchReportTab('overview')">
              T·ªïng Quan
            </button>
            <button class="tab" onclick="switchReportTab('revenue')">
              Doanh Thu
            </button>
            <button class="tab" onclick="switchReportTab('rooms')">
              Th·ªëng K√™ Ph√≤ng
            </button>
            <button class="tab" onclick="switchReportTab('debt')">
              C√¥ng N·ª£
            </button>
          </div>

          <!-- Overview Tab -->
          <div id="overviewTabContent" class="content-section">
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-value" id="overviewTotalRooms">-</div>
                <div class="stat-label">T·ªïng s·ªë ph√≤ng</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="overviewOccupiedRooms">-</div>
                <div class="stat-label">Ph√≤ng ƒë√£ cho thu√™</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="overviewActiveContracts">-</div>
                <div class="stat-label">H·ª£p ƒë·ªìng ƒëang ho·∫°t ƒë·ªông</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="overviewTotalRevenue">-</div>
                <div class="stat-label">T·ªïng doanh thu</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="overviewTotalDebt">-</div>
                <div class="stat-label">T·ªïng c√¥ng n·ª£</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="overviewCollectionRate">-%</div>
                <div class="stat-label">T·ª∑ l·ªá thu h·ªìi</div>
              </div>
            </div>
            <!-- Charts for Overview -->
            <div
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
                gap: 20px;
                margin-top: 30px;
              "
            >
              <div
                style="
                  background: white;
                  padding: 20px;
                  border-radius: 8px;
                  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                "
              >
                <h3 style="margin-top: 0">T·ª∑ l·ªá l·∫•p ƒë·∫ßy ph√≤ng</h3>
                <canvas id="roomOccupancyChart"></canvas>
              </div>
              <div
                style="
                  background: white;
                  padding: 20px;
                  border-radius: 8px;
                  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                "
              >
                <h3 style="margin-top: 0">T·ª∑ l·ªá thu h·ªìi c√¥ng n·ª£</h3>
                <canvas id="debtCollectionChart"></canvas>
              </div>
            </div>
          </div>

          <!-- Revenue Tab -->
          <div
            id="revenueTabContent"
            class="content-section"
            style="display: none"
          >
            <h2>B√°o C√°o Doanh Thu</h2>
            <div class="filters">
              <div class="filter-item">
                <select id="revenueYear">
                  <option value="">Ch·ªçn nƒÉm</option>
                </select>
              </div>
              <button class="btn-primary" onclick="loadRevenueReport()">
                Xem b√°o c√°o
              </button>
            </div>
            <div id="revenueContent">
              <div class="loading">
                <div class="spinner"></div>
                <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
              </div>
            </div>
            <!-- Chart container for revenue -->
            <div
              id="revenueChartContainer"
              style="margin-top: 20px; display: none"
            >
              <div
                style="
                  background: white;
                  padding: 20px;
                  border-radius: 8px;
                  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                "
              >
                <h3>Bi·ªÉu ƒë·ªì doanh thu theo th√°ng</h3>
                <canvas id="revenueChart"></canvas>
              </div>
            </div>
          </div>

          <!-- Rooms Statistics Tab -->
          <div
            id="roomsTabContent"
            class="content-section"
            style="display: none"
          >
            <h2>Th·ªëng K√™ Ph√≤ng - M·ª©c ƒê·ªô Quan T√¢m</h2>
            <!-- Chart for room popularity -->
            <div
              id="roomPopularityChartContainer"
              style="margin-bottom: 30px; display: none"
            >
              <div
                style="
                  background: white;
                  padding: 20px;
                  border-radius: 8px;
                  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                "
              >
                <h3>Top 10 ph√≤ng ƒë∆∞·ª£c thu√™ nhi·ªÅu nh·∫•t</h3>
                <canvas id="roomPopularityChart"></canvas>
              </div>
            </div>
            <div id="roomPopularityContent">
              <div class="loading">
                <div class="spinner"></div>
                <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
              </div>
            </div>
          </div>

          <div
            id="popularRoomsSection"
            class="content-section"
            style="display: none"
          >
            <h2>Ph√≤ng ƒê∆∞·ª£c ƒê·∫∑t Nhi·ªÅu Nh·∫•t</h2>
            <div class="table-container">
              <table id="popularRoomsTable">
                <thead>
                  <tr>
                    <th>X·∫øp h·∫°ng</th>
                    <th>M√£ ph√≤ng</th>
                    <th>T√™n ph√≤ng</th>
                    <th>S·ªë l·∫ßn thu√™</th>
                    <th>Doanh thu</th>
                    <th>T·ª∑ l·ªá l·∫•p ƒë·∫ßy</th>
                  </tr>
                </thead>
                <tbody id="popularRoomsTableBody"></tbody>
              </table>
            </div>
          </div>

          <!-- Debt Tab -->
          <div
            id="debtTabContent"
            class="content-section"
            style="display: none"
          >
            <h2>B√°o C√°o C√¥ng N·ª£</h2>
            <!-- Chart for debt analysis -->
            <div
              id="debtChartContainer"
              style="margin-bottom: 30px; display: none"
            >
              <div
                style="
                  background: white;
                  padding: 20px;
                  border-radius: 8px;
                  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                "
              >
                <h3>Ph√¢n t√≠ch c√¥ng n·ª£</h3>
                <canvas id="debtChart"></canvas>
              </div>
            </div>
            <div id="debtContent">
              <div class="loading">
                <div class="spinner"></div>
                <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Room Modal -->
    <div id="roomModal" class="modal">
      <div class="modal-content">
        <h2 class="modal-title" id="roomModalTitle">Th√™m ph√≤ng m·ªõi</h2>
        <div id="roomModalAlert" class="alert"></div>
        <form id="roomForm">
          <input type="hidden" id="roomId" />
          <div class="form-group">
            <label>T√™n ph√≤ng *</label>
            <input type="text" id="roomName" required />
          </div>
          <div class="form-group">
            <label>Lo·∫°i ph√≤ng *</label>
            <select id="roomType" required>
              <option value="">Ch·ªçn lo·∫°i ph√≤ng</option>
              <option value="Ph√≤ng ƒë∆°n">Ph√≤ng ƒë∆°n</option>
              <option value="Ph√≤ng ƒë√¥i">Ph√≤ng ƒë√¥i</option>
              <option value="Ph√≤ng VIP">Ph√≤ng VIP</option>
            </select>
          </div>
          <div class="form-group">
            <label>Gi√° thu√™ (VNƒê) *</label>
            <input type="number" id="roomPrice" required />
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Ti·ªÅn c·ªçc (VNƒê) *</label>
              <input type="number" id="roomDeposit" required />
            </div>
            <div class="form-group">
              <label>Ng√†y thanh to√°n h√†ng th√°ng</label>
              <input
                type="number"
                id="roomPaymentDay"
                min="1"
                max="31"
                value="5"
              />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Gi√° ƒëi·ªán (VNƒê/kWh)</label>
              <input type="number" id="roomElectricPrice" value="3500" />
            </div>
            <div class="form-group">
              <label>Gi√° n∆∞·ªõc (VNƒê/m¬≥)</label>
              <input type="number" id="roomWaterPrice" value="20000" />
            </div>
          </div>
          <div class="form-group">
            <label>Tr·∫°ng th√°i</label>
            <select id="roomStatus">
              <option value="available">C√≤n tr·ªëng</option>
              <option value="occupied">ƒê√£ cho thu√™</option>
              <option value="maintenance">B·∫£o tr√¨</option>
            </select>
          </div>
          <div class="form-group">
            <label>M√¥ t·∫£</label>
            <textarea id="roomDescription" rows="3"></textarea>
          </div>
          <div class="form-actions">
            <button
              type="button"
              class="btn-secondary"
              onclick="closeRoomModal()"
            >
              H·ªßy
            </button>
            <button type="submit" class="btn-primary">L∆∞u</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Tenant Modal -->
    <div id="tenantModal" class="modal">
      <div class="modal-content">
        <h2 class="modal-title" id="tenantModalTitle">Th√™m ng∆∞·ªùi thu√™ m·ªõi</h2>
        <div id="tenantModalAlert" class="alert"></div>
        <form id="tenantForm">
          <input type="hidden" id="tenantId" />
          <div class="form-row">
            <div class="form-group">
              <label>H·ªç t√™n *</label>
              <input type="text" id="tenantName" required />
            </div>
            <div class="form-group">
              <label>S·ªë ƒëi·ªán tho·∫°i *</label>
              <input type="text" id="tenantPhone" required />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>CMND/CCCD *</label>
              <input type="text" id="tenantIdCard" required />
            </div>
            <div class="form-group">
              <label>Ng√†y sinh</label>
              <input type="date" id="tenantDob" />
            </div>
          </div>
          <div class="form-group">
            <label>ƒê·ªãa ch·ªâ *</label>
            <input type="text" id="tenantAddress" required />
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="tenantEmail" />
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>T√™n ƒëƒÉng nh·∫≠p (ƒë·ªÉ ƒëƒÉng nh·∫≠p h·ªá th·ªëng)</label>
              <input
                type="text"
                id="tenantUsername"
                placeholder="T·ª± ƒë·ªông t·∫°o n·∫øu ƒë·ªÉ tr·ªëng"
              />
            </div>
            <div class="form-group">
              <label>M·∫≠t kh·∫©u (m·∫∑c ƒë·ªãnh: 123456)</label>
              <input
                type="password"
                id="tenantPassword"
                placeholder="ƒê·ªÉ tr·ªëng = 123456"
              />
            </div>
          </div>
          <div class="form-group">
            <label>Tr·∫°ng th√°i</label>
            <select id="tenantStatus">
              <option value="active">ƒêang ho·∫°t ƒë·ªông</option>
              <option value="inactive">Ng·ª´ng ho·∫°t ƒë·ªông</option>
            </select>
          </div>
          <div class="form-actions">
            <button
              type="button"
              class="btn-secondary"
              onclick="closeTenantModal()"
            >
              H·ªßy
            </button>
            <button type="submit" class="btn-primary">L∆∞u</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Contract Modal -->
    <div id="contractModal" class="modal">
      <div class="modal-content">
        <h2 class="modal-title" id="contractModalTitle">T·∫°o h·ª£p ƒë·ªìng m·ªõi</h2>
        <div id="contractModalAlert" class="alert"></div>
        <form id="contractForm">
          <input type="hidden" id="contractId" />
          <div class="form-row">
            <div class="form-group">
              <label>Ng∆∞·ªùi thu√™ *</label>
              <select id="contractTenantId" required></select>
            </div>
            <div class="form-group">
              <label>Ph√≤ng *</label>
              <select id="contractRoomId" required></select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Ng√†y b·∫Øt ƒë·∫ßu *</label>
              <input type="date" id="contractStartDate" required />
            </div>
            <div class="form-group">
              <label>Ng√†y k·∫øt th√∫c *</label>
              <input type="date" id="contractEndDate" required />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Gi√° thu√™/th√°ng (VNƒê) *</label>
              <input type="number" id="contractMonthlyRent" required />
            </div>
            <div class="form-group">
              <label>Ti·ªÅn c·ªçc (VNƒê) *</label>
              <input type="number" id="contractDeposit" required />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Gi√° ƒëi·ªán (VNƒê/kWh)</label>
              <input type="number" id="contractElectricPrice" value="3500" />
            </div>
            <div class="form-group">
              <label>Gi√° n∆∞·ªõc (VNƒê/m¬≥)</label>
              <input type="number" id="contractWaterPrice" value="20000" />
            </div>
          </div>
          <div class="form-group">
            <label>Ng√†y thanh to√°n h√†ng th√°ng</label>
            <input
              type="number"
              id="contractPaymentDay"
              min="1"
              max="31"
              value="5"
            />
          </div>
          <div class="form-group">
            <label>Ghi ch√∫</label>
            <textarea id="contractNotes" rows="3"></textarea>
          </div>
          <div class="form-actions">
            <button
              type="button"
              class="btn-secondary"
              onclick="closeContractModal()"
            >
              H·ªßy
            </button>
            <button type="submit" class="btn-primary">L∆∞u</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Scripts -->
    <!-- Load admin.js FIRST (no defer) to expose getAuthHeader and utilities -->
    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
    <!-- Load other scripts (they depend on admin.js) -->
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
    <script src="{{ url_for('static', filename='js/rooms.js') }}"></script>
    <script src="{{ url_for('static', filename='js/tenants.js') }}"></script>
    <script src="{{ url_for('static', filename='js/contracts.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bookings.js') }}"></script>
    <script src="{{ url_for('static', filename='js/reports.js') }}"></script>
    <script>
      // Wait for all scripts then initialize
      document.addEventListener("DOMContentLoaded", function () {
        const checkReady = () => {
          if (
            window.scriptsLoaded?.tenants &&
            window.scriptsLoaded?.contracts &&
            window.scriptsLoaded?.bookings &&
            window.scriptsLoaded?.rooms &&
            window.scriptsLoaded?.dashboard &&
            window.scriptsLoaded?.reports
          ) {
            console.log("All scripts ready, initializing admin...");
            if (typeof window.initializeAdmin === "function") {
              window.initializeAdmin();
            } else {
              console.error("initializeAdmin function not found!");
            }
          } else {
            setTimeout(checkReady, 50);
          }
        };
        checkReady();
      });
    </script>
  </body>
</html>
